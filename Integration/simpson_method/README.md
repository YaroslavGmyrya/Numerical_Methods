# Метод Симпсона

Метод симпсона заменяет функцию на отрезке парабалой (полином 2 степени). Чтобы построить параболу, нужно 3 точки, поэтому отрезок будет $[x_i;x_{i+2}]$.

[![image.png](https://i.postimg.cc/GmctcT05/image.png)](https://postimg.cc/pp6RCTLf)


[![image.png](https://i.postimg.cc/7L2pdXs8/image.png)](https://postimg.cc/Y4tnmNBb)

Полином 2 степени можно представить в виде первой формулы Ньютона. Эта формула является другой формой записи той формулы, которая была рассмотрена мною ранее. Она более удобна и быстрее для вычислений в случае, когда узлы интерполяции расположены на равном расстоянии друг от друга. Здесь $\delta y$ - не разделенная разность, как в предыдущей формуле, а конечная разность:

$$\delta y = y_{i+1} - y_i$$
$$\delta^2 y = \delta y_{i+1} - \delta y_i = y_{i+2} - y_{i+1} - (y_{i+1} - y_i) = y_{i+2} - 2y_{i+1} + y_i$$

[![image.png](https://i.postimg.cc/1572zbb1/image.png)](https://postimg.cc/YhgbnDpd)

[![image.png](https://i.postimg.cc/52xqQmQ5/image.png)](https://postimg.cc/Tp4WZg9h)

Просуммировав все выражения на отрезке, можно заметить, что значения функции в точках с четным индексом входят в выражения 2 раза (т.к конец одного промежутка интерполяции является началом другого). Вынесем множитель 2 за знак суммы. Все точки с нечетным номером имеют множитель 4, его тоже можем вынести за знак суммы. Первая точка (с индексом 0) и послендяя - исключения, значения функции в этих точках просто добавляются к общей сумме.

## Погрешность

[![image.png](https://i.postimg.cc/tC79qK2F/image.png)](https://postimg.cc/7fvFXWvL)

Метод Симпсона имеет точность вдвое выше, чем у предыдущих методов. При равных h метод даст точность в 2 раза выше, чем предыдущие, а если увеличить шаг для метода симпсона в 2 раза, то он будет иметь точность, как у прошлых методов.

# Алгоритм

[![image.png](https://i.postimg.cc/yxnLGpwP/image.png)](https://postimg.cc/YLGNGR2G)


